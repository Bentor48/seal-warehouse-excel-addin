<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Меню</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        .button{
            font-size: var(--headerFontSize) !important;
            margin-bottom: 20px;
        }

        #selectedType {
            font-size: var(--headerFontSize);
        }
    </style>
</head>

<body class="forForm">
    <!-- ЭКРАН 1 -->
    <div id="typeSelect">
        <button class="button submit" onclick="selectType('ring', 'Кольцо')">Кольцо</button>
        <button class="button submit" onclick="selectType('metal', 'Металл')">Металл / Неметалл</button>
    </div>
    <!-- ЭКРАН 2 -->
    <div id="actionSelect">
        <div class="container head">
            <p id="selectedType"></p>
        </div>
        <button class="button submit" onclick="go('add')">Добавить</button>
        <button class="button submit" onclick="go('search')">Поиск</button>

        <button class="button back" id="backButton" onclick="back()">Назад</button>
    </div>
    <script>

        let selectedType = null;

        const typeSelect = document.getElementById("typeSelect");
        const actionSelect = document.getElementById("actionSelect");
        const selectedTypeText = document.getElementById("selectedType");

        // при загрузке показываем только экран выбора типа
        actionSelect.style.display = "none";

        function selectType(type, title) {
        selectedType = type;

        if (title === 'Металл') {
            title = 'Металл / Неметалл';
        }

        selectedTypeText.textContent = "Выбран тип: " + title;

        typeSelect.style.display = "none";
        actionSelect.style.display = "block";
        }

        function back() {
        selectedType = null;

        actionSelect.style.display = "none";
        typeSelect.style.display = "block";
        }

        function go(action) {
        if (!selectedType) return;
        const url = `${selectedType}-${action}.html`;
        window.location.href = url;
        }

        Office.onReady(() => {
        console.log("Office готов — сбрасываем фильтр");
        resetHiddenRows();
        });

        async function resetHiddenRows() {
        await Excel.run(async (context) => {
                const sheet = context.workbook.worksheets.getActiveWorksheet();
                const usedRange = sheet.getUsedRange();
                usedRange.load("rowCount");
                await context.sync();
        // начинаем с 3 строки (index 2)
        for (let i = 1; i < usedRange.rowCount; i++) {
            sheet.getRangeByIndexes(i, 0, 1, 1).rowHidden = false;
        }

        await context.sync();
    });
}

</script>

</body>
<footer>
  <p class="footer">
    © 2026 Михаил Полтавский
    <span class="dot">·</span>
    Мой GitHub —
    <a href="https://github.com/Bentor48"
       target="_blank"
       rel="noopener noreferrer"
       class="github-link"
       aria-label="Мой GitHub">

      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"
           xmlns="http://www.w3.org/2000/svg">
        <path d="M12 .5C5.73.5.5 5.74.5 12.02c0 5.11 3.29 9.45 7.86 10.98.58.11.79-.25.79-.56
        0-.28-.01-1.02-.02-2-3.2.7-3.88-1.54-3.88-1.54
        -.53-1.36-1.3-1.72-1.3-1.72
        -1.06-.73.08-.72.08-.72
        1.17.08 1.79 1.2 1.79 1.2
        1.04 1.78 2.73 1.27 3.4.97
        .11-.75.41-1.27.74-1.56
        -2.56-.29-5.26-1.28-5.26-5.69
        0-1.26.45-2.29 1.19-3.1
        -.12-.29-.52-1.46.11-3.05
        0 0 .97-.31 3.18 1.18
        .92-.26 1.9-.39 2.88-.39
        .98 0 1.96.13 2.88.39
        2.2-1.49 3.18-1.18 3.18-1.18
        .63 1.59.23 2.76.11 3.05
        .74.81 1.19 1.84 1.19 3.1
        0 4.42-2.7 5.39-5.27 5.67
        .42.36.8 1.08.8 2.18
        0 1.57-.01 2.84-.01 3.23
        0 .31.21.68.8.56
        4.57-1.53 7.85-5.87 7.85-10.98
        C23.5 5.74 18.27.5 12 .5z"/>
      </svg>
    </a>
  </p>
</footer>
</html>